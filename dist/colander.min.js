const defaults={modelName:"user",propertyName:"permissions"},rejection={message:"Not Authorized"};class Colander{constructor(e=defaults){this.modelName=e.modelName,this.propertyName=e.propertyName}allow(e){return function(t,s,o){return"string"==typeof e?e===t[this.modelName][this.propertyName]?o():s.status(403).send(rejection):"object"==typeof e?e.indexOf(t[this.modelName][this.propertyName])>=0?o():s.status(403).send(rejection):void s.status(403).send(rejection)}}block(e){return function(t,s,o){return"string"==typeof e?e===t[this.modelName][this.propertyName]?s.status(403).send(rejection):o():"object"==typeof e?e.indexOf(t[this.modelName][this.propertyName])>=0?s.status(403).send(rejection):o():s.status(403).send(rejection)}}}module.exports=Colander;